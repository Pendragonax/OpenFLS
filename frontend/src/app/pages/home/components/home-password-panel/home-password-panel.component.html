<mat-expansion-panel class="home-panel mx-2 mb-2">
  <mat-expansion-panel-header class="home-panel-header">
    <mat-panel-title class="home-panel-title">
      <mat-icon>lock</mat-icon>
      Passwort ändern
    </mat-panel-title>
  </mat-expansion-panel-header>

  <div class="container-fluid">
    <div class="row">
      <div class="col">
        <div class="home-panel-subtitle">Hier können Sie ihr Passwort ändern.</div>
        <form [formGroup]="form" class="password-form">
          <div class="row g-3">
            <div class="col-12">
              <mat-form-field appearance="fill" class="w-100">
                <mat-label>altes Passwort</mat-label>
                <input matInput
                       [type]="showOldPassword ? 'text' : 'password'"
                       formControlName="oldPassword"
                       required>
                <button mat-icon-button
                        matSuffix
                        type="button"
                        (click)="toggleOldPasswordVisibility()"
                        [attr.aria-label]="showOldPassword ? 'Passwort verbergen' : 'Passwort anzeigen'">
                  <mat-icon>{{ showOldPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
                </button>
              </mat-form-field>
            </div>

            <div class="col-12 col-lg-5">
              <div class="password-hints">
                <div>Mindestens 9 Zeichen</div>
                <div>1 Kleinbuchstabe</div>
                <div>1 Großbuchstabe</div>
                <div>1 Sonderzeichen (!%*?&)</div>
                <div>1 Zahl</div>
              </div>
            </div>

            <div class="col-12 col-lg-7">
              <div class="password-stack">
                <mat-form-field appearance="fill" class="w-100">
                  <mat-label>neues Passwort</mat-label>
                  <input matInput
                         [type]="showNewPassword ? 'text' : 'password'"
                         formControlName="password1"
                         required>
                  <button mat-icon-button
                          matSuffix
                          type="button"
                          (click)="toggleNewPasswordVisibility()"
                          [attr.aria-label]="showNewPassword ? 'Passwort verbergen' : 'Passwort anzeigen'">
                    <mat-icon>{{ showNewPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
                  </button>
                  @if (password1Control.invalid) {
                    <mat-error>{{ getControlErrorMessage(password1Control) }}</mat-error>
                  }
                </mat-form-field>

                <mat-form-field appearance="fill" class="w-100">
                  <mat-label>Passwort wiederholen</mat-label>
                  <input matInput
                         [type]="showRepeatPassword ? 'text' : 'password'"
                         formControlName="password2" required>
                  <button mat-icon-button
                          matSuffix
                          type="button"
                          (click)="toggleRepeatPasswordVisibility()"
                          [attr.aria-label]="showRepeatPassword ? 'Passwort verbergen' : 'Passwort anzeigen'">
                    <mat-icon>{{ showRepeatPassword ? 'visibility_off' : 'visibility' }}</mat-icon>
                  </button>
                  @if (password2Control.invalid) {
                    <mat-error>{{ getControlErrorMessage(password2Control) }}</mat-error>
                  }
                </mat-form-field>
              </div>
            </div>

            <div class="col-12">
              <button mat-raised-button
                      color="primary"
                      class="password-submit"
                      [disabled]="form.invalid || isSubmitting"
                      (click)="submitPassword.emit()">Passwort ändern</button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</mat-expansion-panel>
